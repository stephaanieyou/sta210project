---
title: "Final Project"
author: "Diane Lin, Stephanie You"
format: pdf
---
Song hotness - artist familiarity, artist hotness, song duration, artist.terms (genre), start of fade out, start of time fade in, song tempo

Linear model, interaction linear model, classifier (logistic)


```{r}

library(tidymodels)
library(tidyverse)

music <- read_csv("music.csv")

```


```{r}

music_filter <- music |>
  filter(str_detect(artist.terms, "rock") |
         str_detect(artist.terms, "rap") |
         str_detect(artist.terms, "pop") |
         str_detect(artist.terms, "country"))

# creating genrealized variables, bc orignial has some subgenres. 

music_filter <- music_filter |>
  mutate(gen_genre = 
           if_else(grepl("rock", music_filter$artist.terms),"rock", 
                   if_else(grepl("rap", music_filter$artist.terms), "rap",
                           if_else(grepl("pop", music_filter$artist.terms), "pop",
                                   if_else(grepl("country", music_filter$artist.terms), "country", "other")))))


music_filter

```


```{r}

#LINEAR MODEL

music_filter <- music_filter |>
  filter(song.hotttnesss > 0)

music_filter


m1 <- lm(song.hotttnesss ~ artist.familiarity + artist.hotttnesss 
         + song.duration + as.factor(gen_genre) + song.start_of_fade_out 
         + song.end_of_fade_in + song.tempo, 
         data = music_filter)


tidy(m1)

summary(m1)


m1_aug <- augment(m1)
m1_aug|>
  ggplot(aes(x = .fitted, y = .resid)) +
  geom_point() +
  geom_hline(yintercept = 0, color = "darkred") +
  labs(title = "Evidence of Constant Variance and Linearity",
         x = "Fitted hotness",
         y = "Residuals")

```

```{r}
#LINEAR W INTERACTION, tempo x duration
library(dplyr)

music_filter <- music_filter %>% filter(song.hotttnesss <= 0)

m2 <- lm(song.hotttnesss ~ artist.familiarity + artist.hotttnesss + song.duration + as.factor(gen_genre) + song.start_of_fade_out
         + song.end_of_fade_in + song.tempo + song.duration*song.tempo, data = music_filter)
summary(m2)

```

```{r}
#classifier

categorical <- music_filter |>
  mutate(cathot = ifelse(song.hotttnesss <= 0.5, "Not Popular", "Popular"))

categorical
```

